# Customizing your Account Portal Redirects

When you set up the Account Portal, Clerk will use your application homepage as the default to redirect users after they sign in to or sign up for your application. If you want to override the defaults or programmatically define your redirect paths you can do that as well via your application. 

For example, if you wanted to redirect your users to `/dashboard` when they sign in, and `/onboarding` when they sign up, this is how you would proceed:

## **************Next.js Middleware**************

### ********************************************Environment Variables********************************************

If using Clerk Middleware with Next.js - you can define it directly environment variables or explicitly in your middleware code as well.

1. NEXT_PUBLIC_CLERK_AFTER_SIGN_IN_URL=/dashboard
2. NEXT_PUBLIC_CLERK_AFTER_SIGN_UP_URL=/onboarding

<aside>
ðŸ’¡ Note, that using routing middleware means that users will be redirected before getting to the app, thus this is the only way to ensure users are redirected correctly. This applies equally to any other middleware tooling you may be using.

</aside>

### afterAuth() Function

If you want a more application level, you can also use the â€˜afterAuth()â€™ function the Clerk Middleware and plug in custom logic to decide where to direct a user between Sign In and Sign Up, and the redirect URL as well, like so:

```tsx
export default authMiddleware({
  afterAuth(auth, req, evt) {
    // handle users who aren't authenticated
    if (!auth.userId && !auth.isPublicRoute) {
      if (req.url === "/onboarding") {
        return redirectToSignUp({ returnBackUrl: "/onboarding" });
      } else if (req.url === "/dashboard") {
        return redirectToSignIn({ returnBackUrl: "/dashboard" });
      }
    }
  },
  publicRoutes: ["/signedout", "/signmein"],
});
```

## Control Components ************************

 You can also explicitly define the redirect paths via the appropriate props in the components:

1. `<ClerkProvider afterSignInUrl='/dashboard' afterSignUpUrl='/onboarding'>`
2. `<RedirectToSignIn afterSignInUrl='/dashboard' afterSignUpUrl='/onboarding'>`

In the case that you are using a Sign In (or Sign Up) button, say from your marketing website, you can also pass through the props into those components:

1. `<SignInButton afterSignInUrl='/dashboard' afterSignUpUrl='/onboarding'>`
2. `<SignUpButton afterSignInUrl='/dashboard' afterSignUpUrl='/onboarding'>`

<aside>
ðŸ’¡ Child component props will always take precedence over parent component props.

</aside>

## Order of precedence

Clerkâ€™s redirects follow the standard hierarchy from local to global, based on which approach you take - this is the order of precedence:

- Middleware
    - AfterAuth()
    - Environment Variables
    - Redirect back to where the user came from

- Component Props
    - RedirectToSignIn props
    - ClerkProvider props
    - Redirect back to where the user came from

## ******************Dashboard Fallbacks******************

If you provide users with a direct link to the account portal pages, you can specify the redirects as a fallback in the dashboard as well. 

Note, while we provide this functionality as a fallback **we do not recommend** configuring this through the dashboard and encourage you to specify redirects in your application flows instead.

1. For development, set your static fallback [localhost](http://localhost) that we will use if we are unable to retrieve a dev browser for your client. In production, this will always be your application homepage. 

    
    ![Screenshot 2023-08-23 at 8.17.34 AM.png](Account%20Portal%20Integration%20Guide%2008567f434a814a328015b32e9b77cee2/Screenshot_2023-08-23_at_8.17.34_AM.png)
    

1. Next, you can specify the fallback redirects through the dashboard as well. 

    
    ![Screenshot 2023-08-23 at 8.25.21 AM.png](Account%20Portal%20Integration%20Guide%2008567f434a814a328015b32e9b77cee2/Screenshot_2023-08-23_at_8.25.21_AM.png)